---
interface Props {
  locale: any;
  suggestion?: string;
}

const { locale, suggestion } = Astro.props;
const defaultTexts = locale.ui.defaultHeroTexts;
---

<div id="hero-text" class="text-center mb-12 px-6">
  <p 
    id="hero-text-content"
    class="text-4xl md:text-6xl lg:text-7xl font-light text-gray-900 dark:text-gray-100 transition-all duration-500 ease-in-out min-h-[120px] md:min-h-[180px] flex items-center justify-center"
  >
    {suggestion || defaultTexts[0]}
  </p>
</div>

<script define:vars={{ defaultTexts }}>
  const heroTextEl = document.getElementById('hero-text-content');
  let currentIndex = 0;
  let isShowingSuggestion = false;

  // Auto-scroll default texts
  function scrollDefaultTexts() {
    if (isShowingSuggestion) return;
    
    currentIndex = (currentIndex + 1) % defaultTexts.length;
    if (heroTextEl) {
      heroTextEl.style.opacity = '0';
      setTimeout(() => {
        if (heroTextEl) {
          heroTextEl.textContent = defaultTexts[currentIndex];
          heroTextEl.style.opacity = '1';
        }
      }, 300);
    }
  }

  // Start auto-scroll (every 5 seconds)
  let scrollInterval = setInterval(scrollDefaultTexts, 5000);

  // Listen for suggestion updates
  document.addEventListener('suggestion-updated', ((e: CustomEvent) => {
    if (heroTextEl && e.detail?.suggestion) {
      isShowingSuggestion = true;
      clearInterval(scrollInterval);
      
      heroTextEl.style.opacity = '0';
      setTimeout(() => {
        if (heroTextEl) {
          heroTextEl.textContent = e.detail.suggestion;
          heroTextEl.style.opacity = '1';
        }
      }, 300);

      // Reset to default after 3 seconds
      setTimeout(() => {
        isShowingSuggestion = false;
        if (heroTextEl) {
          heroTextEl.style.opacity = '0';
          setTimeout(() => {
            if (heroTextEl) {
              heroTextEl.textContent = defaultTexts[currentIndex];
              heroTextEl.style.opacity = '1';
            }
          }, 300);
        }
        scrollInterval = setInterval(scrollDefaultTexts, 5000);
      }, 3000);
    }
  }) as EventListener);
</script>

<style>
  #hero-text-content {
    opacity: 1;
    transition: opacity 0.3s ease-in-out;
  }
</style>
