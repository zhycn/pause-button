---
import Layout from '../layouts/Layout.astro';
import Header from '../components/header/Header.astro';
import HeroText from '../components/hero/HeroText.astro';
import PauseButton from '../components/hero/PauseButton.astro';
import CultureSection from '../components/design/CultureSection.astro';
import Footer from '../components/footer/Footer.astro';
import { detectLanguage, getLocale, getHreflangURLs, type SupportedLocale } from '../i18n';

// 检测当前语言（服务端）
// 处理 Astro.request 可能不存在的情况（SSG 模式）
const headers = Astro.request?.headers || null;
const currentLang = detectLanguage(Astro.url, headers);

const locale = getLocale(currentLang);

---
<Layout>
    <!-- Header -->
    <Header locale={locale} currentLang={currentLang} />

    <!-- Main Content -->
    <main class="flex-1 flex flex-col pt-20 pb-16 sm:pb-20 lg:pb-24">
      <!-- Hero Section - Astro 风格的大留白 -->
      <div class="flex-1 flex flex-col items-center justify-center px-4 sm:px-6 lg:px-8 py-16 sm:py-20 lg:py-32 min-h-[calc(100vh-8rem)]">
        <!-- Hero Text -->
        <HeroText locale={locale} />
        
        <!-- Pause Button -->
        <div class="mt-12 sm:mt-16 lg:mt-20 animate-fade-in" style={{ animationDelay: '300ms' }}>
          <PauseButton locale={locale} />
        </div>
      </div>

      <!-- Culture Section - Astro 风格的卡片区域 -->
      <div class="hidden lg:block">
        <CultureSection locale={locale} />
      </div>
    </main>

    <!-- Footer -->
    <Footer locale={locale} />
</Layout>

<!-- Keyboard shortcuts -->
<script>
  (function() {
    'use strict';
    
    // Global keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      // 空格键触发暂停按钮（不在输入框中时）
      if (e.key === ' ' && e.target === document.body) {
        e.preventDefault();
        const pauseBtn = document.getElementById('pause-btn');
        if (pauseBtn) {
          pauseBtn.click();
        }
      }
    });
  })();
</script>